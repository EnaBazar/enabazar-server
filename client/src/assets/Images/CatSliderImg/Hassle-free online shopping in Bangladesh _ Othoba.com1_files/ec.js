var ec=ec||{logEnable:!0,currPage:"",cur:"BDT",repCur:"Tk",sendVariantInfo:!1,products:[],productRemove:[],disableImpression:!1,homePageSelector:"div.product-details",categoryPageSelector:".product-grid .product-item .product-wrap",manufacturerPageSelector:".manufacturer-page .product-item",vendorPageSelector:".vendor-page .product-item",supplierPageSelector:".supplier-page .product-item",productCampaignPageSelector:".productcampaign-page .product-item",productDetPageSelector:".product-single",cartPageSelector:".dvOrderSummery td.remove-from-cart div.closeMe div.product product-cart",checkOutPageSelector:".order-summary",confirmOrderPageSelector:"confirm",productDetPageYouMayLikeSelector:".crosssell-products-grid .product-item",productDetPageRelatedAndWhoBrought:".also-purchased-products-grid .product-item",minCartSelector:"div.mini-shopping-cart a.remove-cart-item-button div.product product-cart",pageSelector:".current-page a, .individual-page a,.next-page a, .last-page a",searchPageSelector:".dvProductGrid .product-item",promoBannerSelector:"div.swiper-wrapper",promoOfferzoneBannerSelector:".home_page_top_ads",HOMEPAGE:"home",SEARCHPAGE:"search",CATEGORYPAGE:"category",MANUFACTURERPAGE:"manufacturer",VENDORPAGE:"vendor",SUPPLIERPAGE:"supplier",PRODUCTCAMPAIGNPAGE:"campaign",PRODUCTDETAILPAGE:"detail",CARTPAGE:"cart",CHECKOUTPAGE:"checkout",WISHLISTPAGE:"wishlist",CHECKOUTPAGE1:"checkout-login",CHECKOUTPAGE2:"checkout-billing",CHECKOUTPAGE3:"checkout-shipping",CHECKOUTPAGE4:"checkout-payment",ALGOLIASEARCHPAGE:"algolia-search",CONFIRMORDERPAGE:"confirm",PAGENUMBER:0,PRODUCTNUMBER:0,i:function(){ec.bindMinCartEvent();ec.logEnable&&console.log("===============LogManager(GTM) Started====================")},p:function(n){this.currPage=n;this.logEnable&&console.log("Log:"+n);this.currPage===ec.HOMEPAGE?($(function(){ec.sendImpressionsForHomepage($(ec.homePageSelector),ec.HOMEPAGE);ec.sendPromoImpressions();$(ec.promoBannerSelector).find("a").click(function(){var n=ec.preparePromoModels(this,"banner");ec.sentPromoClick(n)});$(ec.promoOfferzoneBannerSelector).find("a").click(function(){var n=ec.preparePromoModels(this,"offer-zone-banner");ec.sentPromoClick(n)})}),ec.bindBuyAndDetailsEvent(ec.homePageSelector,ec.HOMEPAGE)):this.currPage===ec.PRODUCTDETAILPAGE?($(function(){$(".product-cart").on("click",".btn-close",function(){})}),ec.bindBuyAndDetailsEvent(ec.productDetPageYouMayLikeSelector,"Products You May Like"),ec.bindBuyAndDetailsEvent(ec.productDetPageRelatedAndWhoBrought,"Related & Also Buy")):this.currPage===ec.CATEGORYPAGE?($(function(){setTimeout(function(){var n=$(".dl-all-product-from-pages"),t=ec.createProductObjectsFromCategoryPage(n,"CategoryPage");ec.sendCategoryStep(1,t)},5e3)}),ec.bindBuyAndDetailsEvent(ec.categoryPageSelector,ec.CATEGORYPAGE)):this.currPage===ec.MANUFACTURERPAGE?($(function(){ec.sendImpressions($(ec.manufacturerPageSelector),ec.MANUFACTURERPAGE);ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=$(ec.manufacturerPageSelector).length}),ec.bindBuyAndDetailsEvent(ec.manufacturerPageSelector,ec.MANUFACTURERPAGE)):this.currPage===ec.VENDORPAGE?($(function(){ec.sendImpressions($(ec.vendorPageSelector),ec.VENDORPAGE);ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=$(ec.vendorPageSelector).length}),ec.bindBuyAndDetailsEvent(ec.categoryPageSelector,ec.VENDORPAGE)):this.currPage===ec.SUPPLIERPAGE?($(function(){ec.sendImpressions($(ec.supplierPageSelector),ec.SUPPLIERPAGE);ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=$(ec.supplierPageSelector).length}),ec.bindBuyAndDetailsEvent(ec.categoryPageSelector,ec.SUPPLIERPAGE)):this.currPage===ec.PRODUCTCAMPAIGNPAGE?($(function(){ec.sendImpressions($(ec.productCampaignPageSelector),ec.PRODUCTCAMPAIGNPAGE);ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=$(ec.productCampaignPageSelector).length}),ec.bindBuyAndDetailsEvent(ec.productCampaignPageSelector,ec.PRODUCTCAMPAIGNPAGE)):this.currPage===ec.CARTPAGE?setTimeout(function(){var n=$(".dl-cart-page-obj"),t=ec.createProductObjectsFromCartPage(n,"CartPage");ec.sendCartStep(1,t)},3e3):this.currPage===ec.CHECKOUTPAGE?setTimeout(function(){var n=$(".product-cart"),t=ec.createProductObjectsFromMinCartForCheckout(n,"CheckOutPage");ec.sendCheckoutStep(1,t)},3e3):this.currPage===ec.SEARCHPAGE?($(function(){ec.sendImpressions($(ec.searchPageSelector),"search #"+$("#Q").val());ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=$(ec.searchPageSelector).length}),ec.bindBuyAndDetailsEvent(ec.searchPageSelector,ec.SEARCHPAGE)):this.currPage===ec.ALGOLIASEARCHPAGE?$(function(){}):this.currPage===ec.ALGOLIASEARCHPAGE?$(function(){}):this.currPage===ec.CONFIRMORDERPAGE||this.currPage===ec.WISHLISTPAGE&&setTimeout(function(){var n=$(".dl-wishlist-page-obj"),t=ec.createProductObjectsFromWishListPage(n,"WishListPage");ec.sendWishListStep(1,t)},3e3)},np:function(n){ec.PAGENUMBER>0&&(n===ec.CATEGORYPAGE?($(function(){var n=ec.createProductObjects($(ec.categoryPageSelector),ec.CATEGORYPAGE+" page : "+ec.getPageNumber());n=n.slice(ec.PRODUCTNUMBER);ec.sendImpressionsForProducts(n,ec.CATEGORYPAGE+" page : "+ec.getPageNumber());ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=ec.PRODUCTNUMBER+n.length}),ec.bindBuyAndDetailsEvent($(ec.categoryPageSelector),ec.CATEGORYPAGE)):n===ec.MANUFACTURERPAGE?($(function(){var n=ec.createProductObjects($(ec.manufacturerPageSelector),ec.MANUFACTURERPAGE+" page : "+ec.getPageNumber());n=n.slice(ec.PRODUCTNUMBER);ec.sendImpressionsForProducts(n,ec.MANUFACTURERPAGE+" page : "+ec.getPageNumber());ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=ec.PRODUCTNUMBER+n.length}),ec.bindBuyAndDetailsEvent($(ec.manufacturerPageSelector),ec.MANUFACTURERPAGE)):n===ec.VENDORPAGE?($(function(){var n=ec.createProductObjects($(ec.vendorPageSelector),ec.VENDORPAGE+" page : "+ec.getPageNumber());n=n.slice(ec.PRODUCTNUMBER);ec.sendImpressionsForProducts(n,ec.VENDORPAGE+" page : "+ec.getPageNumber());ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=ec.PRODUCTNUMBER+n.length}),ec.bindBuyAndDetailsEvent($(ec.vendorPageSelector),ec.VENDORPAGE)):n===ec.PRODUCTCAMPAIGNPAGE&&($(function(){var n=ec.createProductObjects($(ec.productCampaignPageSelector),ec.PRODUCTCAMPAIGNPAGE+" page : "+ec.getPageNumber());n=n.slice(ec.PRODUCTNUMBER);ec.sendImpressionsForProducts(n,ec.PRODUCTCAMPAIGNPAGE+" page : "+ec.getPageNumber());ec.PAGENUMBER=ec.getPageNumber();ec.PRODUCTNUMBER=ec.PRODUCTNUMBER+n.length}),ec.bindBuyAndDetailsEvent($(ec.productCampaignPageSelector),ec.PRODUCTCAMPAIGNPAGE)))},bindCheckOutEvent:function(n){if(n==1)$(function(){var n=$("table.shop-table.cart-table tbody tr[data-orderitemid]"),t=ec.createProductObjectsFromCart(n,"CheckOutPage");ec.sendCheckoutStep(1,t)});else{var t=$(".product-cart"),i=ec.createProductObjectsFromMinCart(t,"CheckOutPage");ec.sendCheckoutStep(1,i)}},bindPageEvent:function(n,t){$(function(){$(n).click(function(){ec.ProductCount1=ec.createProductObjects(t).length;ec.logEnable&&console.log("Product Count(before) :");ec.sendImpressions(t,"2nd Page")})})},bindBuyAndDetailsEvent:function(n,t){$(function(){$(n).find("input.product-box-add-to-cart-button").click(function(n){ec.sendAddToCart($(n.target).closest("div.product-item"))});$(n).find("h2.product-title a").click(function(n){ec.sendProductClick($(n.target).closest("div.product-item"),t)});$(n).find("a.btn-details").click(function(n){ec.sendProductClick($(n.target).closest("div.product-item"),t)})})},bindMinCartEvent:function(){$(function(){ec.bindMinCartEventRoot()})},bindMinCartEventRoot:function(){$(".product-cart").on("click",".btn-close",function(){});$('input[value="Checkout"]').click(function(){ec.bindCheckOutEvent(0)})},bindCartEvent:function(){$(function(){$(".btn-close").click(function(){})});$(".checkout-buttons").on("click",".btn-checkout",function(){ec.bindCheckOutEvent(1)})},getPageNumber:function(){return $("div.pager li.current-page").length>0?parseInt($("div.pager li.current-page").text()):0},sendImpressionsForHomepage:function(n,t,i){if(!ec.disableImpression){var r=ec.createProductObjectsForHomepage(n,t);i>0&&r.length>i&&(r=r.slice(r.length-i,i));dataLayer.push({event:"productImpressions",ecommerce:{currencyCode:ec.cur,impressions:r}});ec.logEnable&&console.log(r.length+" # impression sent # page type # "+t)}},createProductObjectsForHomepage:function(n,t){var i=[],r;return n==undefined?i:(r=n.length,$.each(n,function(n,u){var f={};f.id=$(u).attr("data-productid");f.name=$(u).find(".product-name a").text();f.price=$(u).find(".new-price").text().replace(ec.repCur,"");t=="category"?f.category=$(".category-page .page-title h1").text():t=="vendor"?f.vendor=$(".vendor-page .page-title h1").text():t=="manufacturer"?f.brand=$(".manufacturer-page .page-title h1").text():t=="campaign"&&(f.campaign=$(".productcampaign-page .page-title h1").text());f.position=r>1?n:u.position||0;t&&(f.list=t);i.push(f)}),i)},createProductObjects:function(n,t){var i=[],r;return n==undefined?i:(r=n.length,$.each(n,function(n,u){var f={};f.id=$(u).attr("data-productid");f.name=$(u).find("h2.product-title a").text();f.price=$(u).find(".actual-price").text().replace(ec.repCur,"");f.brand=$(u).find(".brand a").text();f.category=$(".category a").text();f.vendor=$(u).attr("data-productv");t=="category"?f.category=$(".category-page .page-title h1").text():t=="vendor"?f.vendor=$(".vendor-page .page-title h1").text():t=="manufacturer"?f.brand=$(".manufacturer-page .page-title h1").text():t=="campaign"&&(f.campaign=$(".productcampaign-page .page-title h1").text());f.position=r>1?n:u.position||0;t&&(f.list=t);i.push(f)}),i)},createProductDetailsObjects:function(n,t){var i=[],r;return n==undefined?i:(r=n.length,$.each(n,function(n,u){var f={};f.item_id=$(u).find("div.sku span.value").text().trim();f.item_name=$(u).find("h1").text().trim();f.item_sku=$(u).find("div.sku span.value").text().trim();f.item_vendor=$(u).find("div.product-vendor span.value a").text().trim();f.affiliation="";f.coupon="";f.discount="";f.index=r>1?n:u.position||0;t&&(f.list=t);f.item_brand=$(u).find("div.product-manufacturer span.value").text().trim();f.item_category=$(u).find(".product-category a").text().trim();f.item_category2="";f.item_category3="";f.item_category4="";f.item_category5="";f.item_list_id="";f.item_list_name="";f.item_variant="";f.location_id="";f.price=$(u).find("span[itemprop='price']").text().trim().replace(ec.repCur,"");f.quantity=$(u).find(".quantity.form-control").val();ec.sendVariantInfo===!0&&$.each($(".attributes ul.option-list"),function(n,t){var i=$(t).find("label.text-prompt");i.length>0&&($(t).find("ul.option-list").length>0&&$(t).find("ul.option-list input[type='radio']:checked").length>0?(f.variant=f.variant+$(i).text().trim(),f.variant=f.variant+":"+$(t).find("ul.option-list input[type='radio']:checked").next("label").html()):$(t).find("select").length>0&&(f.variant=f.variant+$(i).text().trim(),f.variant=f.variant+":"+$(t).find("select option:selected").html().trim()))});i.push(f)}),i)},sendImpressions:function(n,t,i){if(!ec.disableImpression){var r=ec.createProductObjects(n,t);i>0&&r.length>i&&(r=r.slice(r.length-i,i));dataLayer.push({event:"productImpressions",ecommerce:{currencyCode:ec.cur,impressions:r}});ec.logEnable&&console.log(r.length+" # impression sent # page type # "+t)}},sendImpressionsForProducts:function(n,t){ec.disableImpression||(dataLayer.push({ecommerce:{currencyCode:ec.cur,impressions:n}}),ec.logEnable&&console.log(n.length+" # impression sent # page type # "+t))},sendProductClick:function(n,t){dataLayer.push({event:"productClick",ecommerce:{click:{actionField:{list:t||"none"},products:ec.createProductObjects(n)}}})},sendProductView:function(n){dataLayer.push({event:"view_item",ecommerce:{currency:ec.cur,detail:{products:ec.createProductDetailsObjects(n)}}})},sendAddToCart:function(n){var t=ec.createProductObjects(n);dataLayer.push({event:"addToCart",ecommerce:{currencyCode:ec.cur,add:{products:t}}});ec.bindMinCartEvent();ec.logEnable&&console.log("Proudct has been added to cart. id #"+n)},sendAddToCartProductDetails:function(n){dataLayer.push({event:"addToCart",ecommerce:{currencyCode:ec.cur,add:{products:n}}});ec.bindMinCartEvent()},sendRemoveFromMinCart:function(n){dataLayer.push({event:"removeFromCart",ecommerce:{currencyCode:ec.cur,remove:{products:ec.createProductObjectsFromMinCart(n)}}})},createProductObjectsFromMinCart:function(n){var t=[],i;return n==undefined?t:(i=n.length,$.each(n,function(n,i){var r={};r.sku=$(i).find(".sku-flyout-cart span").text();r.name=$(i).find(".product-name").text();r.quantity=$(i).find(".product-quantity").val();r.price=$(i).find(".product-price").text().replace("/Per Pcs","").replace(ec.repCur,"");$(i).find("div.attributes").length&&(r.variant=$(i).find("div.attributes").text().trim().split(":")[1].trim());r.list="MinShoppingCart";t.push(r)}),t)},createProductObjectsFromMinCartForCheckout:function(n){var t=[],i;return n==undefined?t:(i=n.length,$.each(n,function(n,i){var r={};if(r.item_id=$(i).find(".dl-product-sku").val(),r.item_sku=$(i).find(".dl-product-sku").val(),r.item_name=$(i).find(".product-name").text(),r.index=n,r.affiliation="Othoba",r.quantity=Number($(i).find(".product-quantity").val()),r.discount=Number($(i).find(".dl-cart-discount").text().replace("/Per Pcs","").replace(ec.repCur,"")),r.item_brand=$(i).find(".dl-manufacturer-name").val(),r.price=Number($(i).find(".product-price").text().replace("/Per Pcs","").replace(ec.repCur,"")),r.currency=ec.cur,$(i).find(".dl-categoires").length){let n=$(i).find(".dl-categoires").length;$(".dl-categoires").each(function(t){t<=n&&(t==0?r.item_category=$(this).val():r["item_category"+t]=$(this).val())})}r.item_list_id="";r.item_list_name="";r.item_variant=$(i).find(".dl-attributeInfo").val();r.location_id="";t.push(r)}),t)},createProductObjectsFromCartPage:function(n){var t=[],i;return n==undefined?t:(i=n.length,$.each(n,function(n,i){var r={};if(r.item_id=$(i).find(".dl-cart-sku").val(),r.item_sku=$(i).find(".dl-cart-sku").val(),r.item_name=$(i).find(".product-name a").text(),r.index=n,r.affiliation="Othoba",r.quantity=Number($(i).find(".dl-cart-quantity").val()),r.discount=Number($(i).find(".dl-cart-discount").val().replace("/Per Pcs","").replace(ec.repCur,"")),r.item_brand=$(i).find(".dl-manufacturer-name").val(),r.price=Number($(i).find(".product-price span").text().replace("/Per Pcs","").replace(ec.repCur,"")),r.currency=ec.cur,$(i).find(".dl-categoires").length){let n=$(i).find(".dl-categoires").length;$(".dl-categoires").each(function(t){t<=n&&(t==0?r.item_category=$(this).val():r["item_category"+t]=$(this).val())})}r.item_list_id="";r.item_list_name="";r.item_variant=$(i).find(".dl-cart-attributeInfo").val();r.location_id="";t.push(r)}),t)},createProductObjectsFromWishListPage:function(n){var t=[],i;return n==undefined?t:(i=n.length,$.each(n,function(n,r){if(n===i-1){var u={};if(u.item_id=$(r).find(".dl-product-id").val(),u.item_name=$(r).find(".dl-product-name").val(),u.affiliation="Othoba",u.quantity=Number($(r).find(".dl-cart-quantity").val()),u.discount=Number($(r).find(".dl-cart-discount").val()),u.item_brand=$(r).find(".dl-manufacturer-name").val(),u.price=Number($(r).find(".dl-product-price").val()),u.currency=ec.cur,$(r).find(".dl-categoires").length){let n=$(r).find(".dl-categoires").length;$(".dl-categoires").each(function(t){t<=n&&(t==0?u.item_category=$(this).val():u["item_category"+t]=$(this).val())})}u.list="WishListPage";u.item_list_id="";u.item_list_name="";u.item_variant=$(r).find(".dl-product-attributeInfo").val();u.location_id="";t.push(u)}}),t)},createProductObjectsFromCategoryPage:function(n){var t=[],i;return n==undefined?t:(i=n.length,$.each(n,function(n,i){let u=Number($(i).find(".old-price").text().replace("/Per Pcs","").replace(ec.repCur,"").trim()),f=Number($(i).find(".dl-new-price-product").text().replace("/Per Pcs","").replace(ec.repCur,"").trim()),e=0;u>0&&(e=u-f);var r={};r.item_id=$(i).find(".dl-product-sku").val();r.item_sku=$(i).find(".dl-product-sku").val();r.item_name=$(i).find(".product-name a").text();r.index=n;r.affiliation="Othoba";r.quantity=1;r.discount=e;r.item_brand=$(i).find(".dl-manufacturer-name").val();r.price=f;r.currency=ec.cur;r.item_category=$(i).find(".dl-category-name").val();r.item_list_name="CategoryPage";t.push(r)}),t)},sendRemoveFromCart:function(n){var t=ec.createProductObjectsFromCart(n);dataLayer.push({event:"removeFromCart",ecommerce:{currency:ec.cur,items:t}})},createProductObjectsFromCart:function(n,t){var i=[],r;return n==undefined?i:(r=n.length,$.each(n,function(n,r){var u={};u.orderitemid=$(r).attr("data-orderitemid");u.name=$(r).find(".product-name a").text();u.quantity=$(r).find(".product-quantity input").val();u.price=$(r).find("td.product-price").text().slice(1).trim().replace(ec.repCur,"");u.currency=ec.cur;u.list="ShoppingCart";t&&(u.list=t);i.push(u)}),i)},sendCategoryStep:function(n,t){var i={step:n};dataLayer.push({event:"view_item_list",ecommerce:{currency:ec.cur,items:t}})},sendCartStep:function(n,t){var r={step:n},i=$(".dl-sub-total-amount span").text();dataLayer.push({event:"view_cart",ecommerce:{currency:ec.cur,value:parseInt(i.replace(ec.repCur,"").trim()),items:t}})},sendWishListStep:function(n,t){var i={step:n};dataLayer.push({event:"add_to_wishlist",ecommerce:{currency:ec.cur,value:t[0].price,items:t}})},sendCheckoutStep:function(n,t){var r={step:n},i=$(".dl-order-total strong").text();dataLayer.push({event:"begin_checkout",ecommerce:{value:parseInt(i.replace(ec.repCur,"").trim()),currency:ec.cur,items:t}})},st:function(n,t,i,r){console.log(ec.products);dataLayer.push({event:"purchase",ecommerce:{transaction_id:n,payment_method:r,currency:ec.cur,shipping:i.replace(ec.repCur,""),value:parseInt(t.replace(ec.repCur,"").trim()),items:ec.products}})},vi:function(){dataLayer.push({event:"view_item",ecommerce:{currency:ec.cur,value:ec.products[0].price,items:ec.products}})},atc:function(){ec.products[0].discount<0&&(ec.products[0].discount=0);dataLayer.push({event:"add_to_cart",ecommerce:{currency:ec.cur,value:ec.products[0].price,items:ec.products}})},preparePromoModels:function(n,t){var r=[],u,i;return n==undefined?r:Array.isArray(n)?(u=n.length,i=t,$.each(n,function(n,t){var u={};u.id=$(t).attr("data-id");u.name=$(t).attr("data-name");u.position=$(t).attr("data-position");i&&(u.creative=i);r.push(u)}),r):{id:$(n).attr("data-id"),name:$(n).attr("data-name"),position:$(n).attr("data-position"),creative:i}},sendPromoImpressions:function(){var n=ec.preparePromoModels($(ec.promoBannerSelector).find("a"),"banner"),t=ec.preparePromoModels($(ec.promoOfferzoneBannerSelector).find("a"),"offer-zone-banner");dataLayer.push({event:"promoImpressions",ecommerce:{promoView:{promotions:n}}});dataLayer.push({event:"promoImpressions",ecommerce:{promoView:{promotions:t}}})},sentPromoClick:function(n){dataLayer.push({event:"promotionClick",ecommerce:{promoClick:{promotions:n}}})},setCookieIfLogIn:function(){document.cookie="logInCookie=logInCookie;"},sentLogInClick:function(){let n=ec.getCookie("logInCookie");n=="logInCookie"&&(document.cookie="logInCookie=alreadylogin;",dataLayer.push({event:"login",loginMethod:"mobilenumber"}))},sentRegisterClick:function(){dataLayer.push({event:"sign_up",Method:"mobilenumber"})},getCookie:function(n){const t=n+"=",r=decodeURIComponent(document.cookie),u=r.split("; ");let i;return u.forEach(n=>{n.indexOf(t)===0&&(i=n.substring(t.length))}),i},sentRemoveAddToCartClick:function(){dataLayer.push({event:"remove_from_cart",ecommerce:{currency:ec.cur,value:ec.productRemove[0].price,items:ec.productRemove}})},sentAddToCartClick:function(){var n=$("#bntUseAsAddToCartData").text();n=n.replace("ec.vi","ec.atc");eval(n)}};ec.i()