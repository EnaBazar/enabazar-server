var AjaxCart={loadWaiting:!1,usepopupnotifications:!1,topcartselector:"",topwishlistselector:"",flyoutcartselector:"",possibleShipmentSelector:"",orderSummaryCheckout:"",localized_data:!1,init:function(n,t,i,r,u,f,e){this.loadWaiting=!1;this.usepopupnotifications=n;this.topcartselector=t;this.topwishlistselector=i;this.flyoutcartselector=r;this.possibleShipmentSelector=u;this.orderSummaryCheckout=f;this.localized_data=e},setLoadWaiting:function(n){displayAjaxLoading(n);this.loadWaiting=n},addproducttocart_catalog:function(n){if(this.loadWaiting===!1){this.setLoadWaiting(!0);var t={};addAntiForgeryToken(t);$.ajax({cache:!1,url:n,type:"POST",data:t,success:this.success_process,complete:this.resetLoadWaiting,error:this.ajaxFailure})}},addproducttocart_details:function(n,t){this.loadWaiting===!1&&(this.setLoadWaiting(!0),$.ajax({cache:!1,url:n,data:$(t).serialize(),type:"POST",success:this.success_process,complete:function(){AjaxCart.setLoadWaiting(!1);var n=$(".detailspageaddtocart").attr("data-productid");AjaxCart.showWishPostText(n);ec.sendAddToCartClick()},error:this.ajaxFailure}))},addproducttocomparelist:function(n){if(this.loadWaiting===!1){this.setLoadWaiting(!0);var t={};addAntiForgeryToken(t);$.ajax({cache:!1,url:n,type:"POST",data:t,success:this.success_process,complete:this.resetLoadWaiting,error:this.ajaxFailure})}},success_process:function(n){return(n.updatetopcartsectionhtml&&($(AjaxCart.topcartselector).html(n.updatetopcartsectionhtml),$("#toggleMiniCart .product-quantity").html(n.updatetopcartsectionhtml),$(".cart-dropdown").addClass("opened"),$(".phone-popup").magnificPopup("close")),n.updatetopcartsectionhtml&&($(AjaxCart.topcartselector).html(n.updatetopcartsectionhtml),$("#toggleMiniCart .product-quantity").html(n.updatetopcartsectionhtml),$(".cart-dropdown").addClass("opened")),n.updateCheckoutPossibleShippment&&$(AjaxCart.possibleShipmentSelector).html(n.updateCheckoutPossibleShippment),n.updateCheckoutOrderSummary&&$(AjaxCart.orderSummaryCheckout).html(n.updateCheckoutOrderSummary),n.updatetopwishlistsectionhtml&&$(AjaxCart.topwishlistselector).html(n.updatetopwishlistsectionhtml),n.updateflyoutcartsectionhtml&&($(AjaxCart.flyoutcartselector).replaceWith(n.updateflyoutcartsectionhtml),$(".cart-dropdown").addClass("opened")),n.message)?(n.success===!0?AjaxCart.usepopupnotifications===!0?displayPopupNotification(n.message,"success",!0):displayBarNotification(n.message,"success",5500):AjaxCart.usepopupnotifications===!0?displayPopupNotification(n.message,"error",!0):displayBarNotification(n.message,"error",0),!1):n.redirect?(location.href=n.redirect,!0):!1},resetLoadWaiting:function(){AjaxCart.setLoadWaiting(!1)},ajaxFailure:function(){alert(this.localized_data.AjaxCartFailure)},removeShoppingCartItem:function(n){if(this.loadWaiting===!1){this.setLoadWaiting(!0);var t=window.location.pathname;$.ajax({cache:!1,url:n,data:{pathName:t},type:"GET",success:this.success_process,complete:this.resetLoadWaiting,error:this.ajaxFailure})}},enterdiscountcoupon:function(n){var t=$("#discountcouponcode").val();this.loadWaiting===!1&&(this.setLoadWaiting(!0),$.ajax({cache:!1,url:n,data:{discountcouponcode:t,pathName:window.location.pathname},type:"post",success:this.success_process,complete:this.resetLoadWaiting,error:this.ajaxFailure}))},removediscountcoupon:function(n){this.loadWaiting===!1&&(this.setLoadWaiting(!0),$.ajax({cache:!1,url:n,type:"post",success:this.success_process,complete:this.resetLoadWaiting,error:this.ajaxFailure}))},setChangedLocation:function(n,t,i,r,u){var f=n+' <i class="fa fa-map-marker" aria-hidden="true"><\/i> '+i+'<i class="fa fa-angle-down" aria-hidden="true"><\/i> '+u;$(".current-location-name").text("");$(".current-location-name").html(f);$(".current-location-id").val(r)},changeCurrentLocation:function(n,t,i,r){AjaxCart.setLoadWaiting(!0);var u={ProductId:r,StateProvinceId:n,AreaOrUpzilaId:t,LoadShippingCharge:i};return addAntiForgeryToken(u),$.ajax({type:"POST",url:"/Customer/ChangeShippingLocation",data:u,dataType:"json",success:function(n){if(n.invalid_location){displayBarNotification(n.message,"error",3500);return}currentStateProvinceId=n.state_id;AjaxCart.setChangedLocation(n.div_name,n.div_id,n.state_name,n.state_id,n.area_name,n.area_id);n.restricted_shipping?($("#home-delivery-"+r).hide(),$("#home-delivery1-"+r).hide(),$(".product-shipping-warning").show(),$(".product-shipping-warning").html(n.shipping_warning)):i&&($("#delivery-charge-"+r).text(n.shipping_charge),$("#home-delivery-"+r).show(),$("#home-delivery1-"+r).show(),$(".product-shipping-warning").hide());notifyChangedLocation&&!clickButton&&displayBarNotification(n.message,"success",3500);notifyChangedLocation=!0},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){AjaxCart.setLoadWaiting(!1)}})},showWishPostText:function(){AjaxCart.setLoadWaiting(!0);var t=$(".detailspageaddtocart").attr("data-productid"),n={ProductId:t};return addAntiForgeryToken(n),$.ajax({type:"GET",url:"/Product/ShouldShowWishInput",data:n,dataType:"json",success:function(n){n.success&&$.magnificPopup.open({items:{src:$("#wishpot_popup").html(),type:"inline"}})},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){AjaxCart.setLoadWaiting(!1)}})},saveWishPostText:function(){AjaxCart.setLoadWaiting(!0);var t=$(".detailspageaddtocart").attr("data-productid"),n={ProductId:t,Message:$("#wishpostcontent").val()};return addAntiForgeryToken(n),$.ajax({type:"POST",url:"/ShoppingCart/SaveWishPost",data:n,dataType:"json",success:function(n){n.success&&$.magnificPopup.open({items:{src:$("#wishpot_popup_result").html(),type:"inline"}})},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){AjaxCart.setLoadWaiting(!1)}})},validatePhoneNumberProductDetails:function(n,t){var u,i,r;if(this.loadWaiting===!1){if(this.setLoadWaiting(!0),u=/^(?:\+880|880|00880|0)?(1)([3-9])(\d{8})$/,i=$("#customerPhone").val(),u.test(i))$("#customerPhoneValidation").text(""),$("#loaderContainer").css("display","block");else{$("#customerPhoneValidation").text("Please Insert A Valid Phone Number");this.setLoadWaiting(!1);return}r={phoneNumber:i};addAntiForgeryToken(r);$.ajax({cache:!1,url:"/ShoppingCart/SendVerificationCode",type:"POST",data:r,success:function(i){i.isAlreadyVerified?AjaxCart.addproducttocart_details(n,t):i.isVerificationCodeSent?setTimeout(function(){$("#phonenoPopupTab").css("display","none");$("#phoneno-popup").css("display","none");$("#verificationPhone").addClass("active");$("#verificationPopup").css("display","block");$("#verificationPhone").css("display","block");$("#buttonForResend").attr("disabled","disabled");$("#buttonForResend").removeClass("btn-primary");$("#buttonForResend").addClass("Resend-Not-allowed");$("#customerVerificationPhoneNumber").val(i.phoneNumber);AjaxCart.countdownForResend()},2500):i.isAlreadyRegister?setTimeout(function(){$("#phonenoPopupTab").css("display","none");$("#phoneno-popup").css("display","none");$("#alreadyRegisterPhoneNumber").val(i.customerRegisterPhoneNumber);$("#alreadyRegisterPhone").addClass("active");$("#alreadyRegisterPhone").css("display","block");$("#passwordChangeHeader").css("display","block")},2500):i.isMaximumLimitExit!="undefined"&&($("#customerPhoneValidation").text(i.msg),AjaxCart.setLoadWaiting(!1),$("#customerVerificationCodeValidation").text(i.msg))},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){AjaxCart.setLoadWaiting(!1)}})}},verifyCode:function(n,t){var r=$("#customerPhoneVerificationCode").val(),u=$("#customerVerificationPhoneNumber").val(),i;if(!/^[0-9]+$/.test(r)){$("#customerPhoneValidation").text("Please Insert A Valid Phone Number");this.setLoadWaiting(!1);return}i={verificationCode:r,verificationPhoneNumber:u};addAntiForgeryToken(i);$.ajax({cache:!1,url:"/ShoppingCart/VerificationCode",type:"POST",data:i,success:function(i){i.idVerified?(AjaxCart.setLoadWaiting(!1),AjaxCart.addproducttocart_details(n,t)):($("#customerVerificationCodeValidation").text("Enter a valid verification code please"),AjaxCart.setLoadWaiting(!1))},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){console.log("Errorhappen")}})},clearPhoneNumberProductDetails:function(){$("#customerPhoneValidation").text()},addproducttocart_sendOTP:function(){this.loadWaiting===!1&&($.magnificPopup.open({items:{src:".phone-popup",closeOnBgClick:!0},closeOnBgClick:!0}),$(".mfp-close").css("cssText","display:block !important"))},addproducttocart_sendCancelOTP:function(){this.loadWaiting===!1&&($("#phonenoPopupTab").css("display","block"),$("#phoneno-popup").css("display","block"),$("#phoneno-popup").addClass("active"),$("#phonenoPopupTab").addClass("active"),$("#customerPhone").val(null),$("#alreadyRegisterPhone").removeClass("active"),$("#alreadyRegisterPhone").css("display","none"),$("#passwordChangeHeader").css("display","none"),$("#loaderContainer").css("display","none"))},addRegisterPassword:function(n,t){var i={},r;i.PhoneOrEmail=$("#alreadyRegisterPhoneNumber").val();i.Password=$("#alreadyRegisterPassword").val();i.RememberMe=$("#RememberMe_Popup").is(":checked")?!0:!1;r={model:i,returnUrl:$("#alreadyRegisterRequestPath").val()};addAntiForgeryToken(r);$.ajax({cache:!1,url:"/Customer/AddToCartLogin",type:"POST",data:r,success:function(i){i.success?(AjaxCart.setLoadWaiting(!1),AjaxCart.addproducttocart_details(n,t)):($("#alreadyRegisterPasswordValidation").text(i.message),AjaxCart.setLoadWaiting(!1))},complete:function(){AjaxCart.setLoadWaiting(!1)},error:function(){console.log("Errorhappen")}})},loadFlyoutCartDetails:function(){var n=$("#cart-details-placeholder");n.html('<div><img src="../Themes/Othoba/Content/images/ajax-loader-small.gif" /> Loading...<\/div>');$.ajax({url:"/ShoppingCart/GetFlyoutDetails",type:"GET",cache:!1,success:function(t){n.html(t.html)},error:function(){console.error("Failed to load cart details.");n.html("<div>Error loading cart details<\/div>")},complete:function(){console.log("Cart details loaded.")}})},countdownForResend:function(){function t(){var i=document.getElementById("counterForResend");n--;i.innerHTML="0:"+(n<10?"0":"")+String(n);n>0?setTimeout(t,1e3):($("#buttonForResend").removeAttr("disabled"),$("#buttonForResend").addClass("btn-primary"),$("#buttonForResend").removeClass("Resend-Not-allowed"),$("#counterForResend").text(""))}var n=60;t()},retryPaymentChangePaymentMethod:function(){this.loadWaiting===!1&&($.magnificPopup.open({items:{src:".retry-popup",closeOnBgClick:!0},closeOnBgClick:!0}),$(".mfp-close").css("cssText","display:block !important"))}}